{"version":3,"sources":["../../../src/modules/pricing/pricing.service.spec.ts"],"sourcesContent":["import { Test, TestingModule } from '@nestjs/testing';\nimport { PricingService } from './pricing.service';\nimport { PrismaService } from '../../prisma/prisma.service';\nimport { CostBreakdown } from '../../common/interfaces';\n\ndescribe('PricingService', () => {\n  let service: PricingService;\n  let prismaService: jest.Mocked<PrismaService>;\n\n  beforeEach(async () => {\n    const mockPrismaService = {\n      pricingConfig: {\n        findFirst: jest.fn(),\n      },\n    };\n\n    const module: TestingModule = await Test.createTestingModule({\n      providers: [\n        PricingService,\n        {\n          provide: PrismaService,\n          useValue: mockPrismaService,\n        },\n      ],\n    }).compile();\n\n    service = module.get<PricingService>(PricingService);\n    prismaService = module.get(PrismaService);\n  });\n\n  it('should be defined', () => {\n    expect(service).toBeDefined();\n  });\n\n  describe('calculateFinancialSummary', () => {\n    it('should calculate financial summary with default config', async () => {\n      // Mock no DB config (use defaults)\n      prismaService.pricingConfig.findFirst.mockResolvedValue(null);\n\n      const costs: CostBreakdown = {\n        material: { category: 'Material', totalCost: 10000000, items: [], totalArea: 1.0, totalQuantity: 10 },\n        boreshKari: { category: 'BoreshKari', totalCost: 0, items: [] },\n        cnc: { category: 'CNC', totalCost: 500000, items: [] },\n        navarShiar: { category: 'NavarShiar', totalCost: 1000000, items: [] },\n        fittings: { category: 'Fittings', totalCost: 2000000, items: [] },\n        painting: { category: 'Painting', totalCost: 0, items: [] },\n        plate: { category: 'Plate', totalCost: 500000, items: [] },\n        woodTools: { category: 'WoodTools', totalCost: 500000, items: [] },\n      };\n\n      const result = await service.calculateFinancialSummary(costs);\n\n      // Subtotal = sum of all categories\n      const expectedSubtotal = 14500000;\n      expect(result.subtotal).toBe(expectedSubtotal);\n\n      // Overhead 1 (25%)\n      expect(result.overheads.overhead1).toBe(expectedSubtotal * 0.25);\n\n      // Overhead 2 (4%)\n      expect(result.overheads.overhead2).toBe(expectedSubtotal * 0.04);\n\n      // Overhead 3 (2%)\n      expect(result.overheads.overhead3).toBe(expectedSubtotal * 0.02);\n\n      // Overhead 4 (2%)\n      expect(result.overheads.overhead4).toBe(expectedSubtotal * 0.02);\n\n      // Contingency (2.5%)\n      expect(result.overheads.contingency).toBe(expectedSubtotal * 0.025);\n\n      // Total overheads\n      const expectedTotalOverheads = expectedSubtotal * (0.25 + 0.04 + 0.02 + 0.02 + 0.025);\n      expect(result.overheads.totalOverheads).toBeCloseTo(expectedTotalOverheads, 0);\n\n      // Total with overheads\n      expect(result.totalWithOverheads).toBe(expectedSubtotal + expectedTotalOverheads);\n\n      // Profit (22%)\n      const expectedProfit = (expectedSubtotal + expectedTotalOverheads) * 0.22;\n      expect(result.profitAmount).toBe(expectedProfit);\n\n      // Final price\n      expect(result.finalPrice).toBe(expectedSubtotal + expectedTotalOverheads + expectedProfit);\n\n      // Profit percentage\n      expect(result.profitPercentage).toBe(0.22);\n    });\n\n    it('should use custom config when provided', async () => {\n      prismaService.pricingConfig.findFirst.mockResolvedValue(null);\n\n      const costs: CostBreakdown = {\n        material: { category: 'Material', totalCost: 10000000, items: [], totalArea: 1.0, totalQuantity: 10 },\n        boreshKari: { category: 'BoreshKari', totalCost: 0, items: [] },\n        cnc: { category: 'CNC', totalCost: 0, items: [] },\n        navarShiar: { category: 'NavarShiar', totalCost: 0, items: [] },\n        fittings: { category: 'Fittings', totalCost: 0, items: [] },\n        painting: { category: 'Painting', totalCost: 0, items: [] },\n        plate: { category: 'Plate', totalCost: 0, items: [] },\n        woodTools: { category: 'WoodTools', totalCost: 0, items: [] },\n      };\n\n      const customConfig = {\n        overhead1: 0.30, // Custom 30%\n        profitMargin: 0.25, // Custom 25%\n      };\n\n      const result = await service.calculateFinancialSummary(costs, customConfig);\n\n      expect(result.overheads.overhead1).toBe(10000000 * 0.30);\n      expect(result.profitPercentage).toBe(0.25);\n    });\n\n    it('should use database config when available', async () => {\n      prismaService.pricingConfig.findFirst.mockResolvedValue({\n        id: '1',\n        overhead1: 0.20,\n        overhead2: 0.05,\n        overhead3: 0.03,\n        overhead4: 0.03,\n        contingency: 0.03,\n        profitMargin: 0.25,\n        isActive: true,\n        createdAt: new Date(),\n        updatedAt: new Date(),\n      });\n\n      const costs: CostBreakdown = {\n        material: { category: 'Material', totalCost: 10000000, items: [], totalArea: 1.0, totalQuantity: 10 },\n        boreshKari: { category: 'BoreshKari', totalCost: 0, items: [] },\n        cnc: { category: 'CNC', totalCost: 0, items: [] },\n        navarShiar: { category: 'NavarShiar', totalCost: 0, items: [] },\n        fittings: { category: 'Fittings', totalCost: 0, items: [] },\n        painting: { category: 'Painting', totalCost: 0, items: [] },\n        plate: { category: 'Plate', totalCost: 0, items: [] },\n        woodTools: { category: 'WoodTools', totalCost: 0, items: [] },\n      };\n\n      const result = await service.calculateFinancialSummary(costs);\n\n      // Should use DB config (20% instead of default 25%)\n      expect(result.overheads.overhead1).toBe(10000000 * 0.20);\n      expect(result.profitPercentage).toBe(0.25);\n    });\n\n    it('should correctly breakdown all cost categories', async () => {\n      prismaService.pricingConfig.findFirst.mockResolvedValue(null);\n\n      const costs: CostBreakdown = {\n        material: { category: 'Material', totalCost: 5000000, items: [], totalArea: 1.0, totalQuantity: 10 },\n        boreshKari: { category: 'BoreshKari', totalCost: 1000000, items: [] },\n        cnc: { category: 'CNC', totalCost: 2000000, items: [] },\n        navarShiar: { category: 'NavarShiar', totalCost: 500000, items: [] },\n        fittings: { category: 'Fittings', totalCost: 3000000, items: [] },\n        painting: { category: 'Painting', totalCost: 1500000, items: [] },\n        plate: { category: 'Plate', totalCost: 1000000, items: [] },\n        woodTools: { category: 'WoodTools', totalCost: 500000, items: [] },\n      };\n\n      const result = await service.calculateFinancialSummary(costs);\n\n      expect(result.breakdown.material).toBe(5000000);\n      expect(result.breakdown.boreshKari).toBe(1000000);\n      expect(result.breakdown.cnc).toBe(2000000);\n      expect(result.breakdown.navarShiar).toBe(500000);\n      expect(result.breakdown.fittings).toBe(3000000);\n      expect(result.breakdown.painting).toBe(1500000);\n      expect(result.breakdown.plate).toBe(1000000);\n      expect(result.breakdown.woodTools).toBe(500000);\n      \n      // Subtotal should be sum of all\n      expect(result.subtotal).toBe(14500000);\n    });\n  });\n\n  describe('calculateOverheads', () => {\n    it('should calculate overheads correctly', () => {\n      const subtotal = 10000000;\n      const overheads = service.calculateOverheads(subtotal);\n\n      // Default config: 0.25 + 0.04 + 0.02 + 0.02 + 0.025 = 0.355\n      const expected = subtotal * 0.355;\n      expect(overheads).toBe(expected);\n    });\n\n    it('should use custom config for overheads', () => {\n      const subtotal = 10000000;\n      const customConfig = {\n        overhead1: 0.30,\n        overhead2: 0.05,\n        overhead3: 0.03,\n        overhead4: 0.03,\n        contingency: 0.04,\n      };\n\n      const overheads = service.calculateOverheads(subtotal, customConfig);\n\n      // Custom: 0.30 + 0.05 + 0.03 + 0.03 + 0.04 = 0.45\n      const expected = subtotal * 0.45;\n      expect(overheads).toBe(expected);\n    });\n  });\n\n  describe('calculateFinalPriceFromSubtotal', () => {\n    it('should calculate final price from subtotal', () => {\n      const subtotal = 10000000;\n      const finalPrice = service.calculateFinalPriceFromSubtotal(subtotal);\n\n      // Overheads: 10M × 0.355 = 3,550,000\n      // With overheads: 13,550,000\n      // Profit (22%): 13,550,000 × 0.22 = 2,981,000\n      // Final: 16,531,000\n      expect(finalPrice).toBeCloseTo(16531000, -3); // Within 1000 Rials\n    });\n  });\n\n  describe('calculateSubtotalFromFinalPrice', () => {\n    it('should reverse calculate subtotal from final price', () => {\n      const finalPrice = 16531000;\n      const subtotal = service.calculateSubtotalFromFinalPrice(finalPrice);\n\n      // Should get back approximately 10,000,000\n      expect(subtotal).toBeCloseTo(10000000, -3); // Within 1000 Rials\n    });\n\n    it('should be inverse of calculateFinalPriceFromSubtotal', () => {\n      const originalSubtotal = 15000000;\n      const finalPrice = service.calculateFinalPriceFromSubtotal(originalSubtotal);\n      const calculatedSubtotal = service.calculateSubtotalFromFinalPrice(finalPrice);\n\n      expect(calculatedSubtotal).toBeCloseTo(originalSubtotal, -2); // Within 100 Rials\n    });\n  });\n\n  describe('getPricingBreakdownPercentages', () => {\n    it('should return default percentages', () => {\n      const percentages = service.getPricingBreakdownPercentages();\n\n      expect(percentages.overhead1Percent).toBe(25);\n      expect(percentages.overhead2Percent).toBe(4);\n      expect(percentages.overhead3Percent).toBe(2);\n      expect(percentages.overhead4Percent).toBe(2);\n      expect(percentages.contingencyPercent).toBe(2.5);\n      expect(percentages.profitPercent).toBe(22);\n      expect(percentages.totalOverheadPercent).toBeCloseTo(35.5, 1);\n    });\n\n    it('should return custom percentages when provided', () => {\n      const customConfig = {\n        overhead1: 0.30,\n        profitMargin: 0.25,\n      };\n\n      const percentages = service.getPricingBreakdownPercentages(customConfig);\n\n      expect(percentages.overhead1Percent).toBe(30);\n      expect(percentages.profitPercent).toBe(25);\n    });\n  });\n\n  describe('getDefaultConfig', () => {\n    it('should return default configuration', () => {\n      const config = service.getDefaultConfig();\n\n      expect(config.overhead1).toBe(0.25);\n      expect(config.overhead2).toBe(0.04);\n      expect(config.overhead3).toBe(0.02);\n      expect(config.overhead4).toBe(0.02);\n      expect(config.contingency).toBe(0.025);\n      expect(config.profitMargin).toBe(0.22);\n    });\n  });\n});\n\n"],"names":["describe","service","prismaService","beforeEach","mockPrismaService","pricingConfig","findFirst","jest","fn","module","Test","createTestingModule","providers","PricingService","provide","PrismaService","useValue","compile","get","it","expect","toBeDefined","mockResolvedValue","costs","material","category","totalCost","items","totalArea","totalQuantity","boreshKari","cnc","navarShiar","fittings","painting","plate","woodTools","result","calculateFinancialSummary","expectedSubtotal","subtotal","toBe","overheads","overhead1","overhead2","overhead3","overhead4","contingency","expectedTotalOverheads","totalOverheads","toBeCloseTo","totalWithOverheads","expectedProfit","profitAmount","finalPrice","profitPercentage","customConfig","profitMargin","id","isActive","createdAt","Date","updatedAt","breakdown","calculateOverheads","expected","calculateFinalPriceFromSubtotal","calculateSubtotalFromFinalPrice","originalSubtotal","calculatedSubtotal","percentages","getPricingBreakdownPercentages","overhead1Percent","overhead2Percent","overhead3Percent","overhead4Percent","contingencyPercent","profitPercent","totalOverheadPercent","config","getDefaultConfig"],"mappings":"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"}