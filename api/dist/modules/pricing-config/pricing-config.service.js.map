{"version":3,"sources":["../../../src/modules/pricing-config/pricing-config.service.ts"],"sourcesContent":["import { Injectable } from '@nestjs/common';\nimport { PrismaService } from '../../prisma/prisma.service';\nimport { UpdatePricingConfigDto } from './dto/update-pricing-config.dto';\n\n@Injectable()\nexport class PricingConfigService {\n  constructor(private readonly prisma: PrismaService) {}\n\n  async getActive() {\n    return this.prisma.pricingConfig.findFirst({\n      where: { isActive: true },\n      orderBy: { createdAt: 'desc' },\n    });\n  }\n\n  async update(updateDto: UpdatePricingConfigDto) {\n    let config = await this.prisma.pricingConfig.findFirst({\n      where: { name: 'default' },\n    });\n\n    if (!config) {\n      config = await this.prisma.pricingConfig.create({\n        data: {\n          name: 'default',\n          isActive: true,\n        },\n      });\n    }\n\n    return this.prisma.pricingConfig.update({\n      where: { id: config.id },\n      data: updateDto,\n    });\n  }\n}\n\n"],"names":["PricingConfigService","getActive","prisma","pricingConfig","findFirst","where","isActive","orderBy","createdAt","update","updateDto","config","name","create","data","id"],"mappings":";;;;+BAKaA;;;eAAAA;;;wBALc;+BACG;;;;;;;;;;AAIvB,IAAA,AAAMA,uBAAN,MAAMA;IAGX,MAAMC,YAAY;QAChB,OAAO,IAAI,CAACC,MAAM,CAACC,aAAa,CAACC,SAAS,CAAC;YACzCC,OAAO;gBAAEC,UAAU;YAAK;YACxBC,SAAS;gBAAEC,WAAW;YAAO;QAC/B;IACF;IAEA,MAAMC,OAAOC,SAAiC,EAAE;QAC9C,IAAIC,SAAS,MAAM,IAAI,CAACT,MAAM,CAACC,aAAa,CAACC,SAAS,CAAC;YACrDC,OAAO;gBAAEO,MAAM;YAAU;QAC3B;QAEA,IAAI,CAACD,QAAQ;YACXA,SAAS,MAAM,IAAI,CAACT,MAAM,CAACC,aAAa,CAACU,MAAM,CAAC;gBAC9CC,MAAM;oBACJF,MAAM;oBACNN,UAAU;gBACZ;YACF;QACF;QAEA,OAAO,IAAI,CAACJ,MAAM,CAACC,aAAa,CAACM,MAAM,CAAC;YACtCJ,OAAO;gBAAEU,IAAIJ,OAAOI,EAAE;YAAC;YACvBD,MAAMJ;QACR;IACF;IA3BA,YAAY,AAAiBR,MAAqB,CAAE;aAAvBA,SAAAA;IAAwB;AA4BvD"}