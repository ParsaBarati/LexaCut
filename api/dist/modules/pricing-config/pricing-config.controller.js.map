{"version":3,"sources":["../../../src/modules/pricing-config/pricing-config.controller.ts"],"sourcesContent":["import { Controller, Get, Put, Body } from '@nestjs/common';\nimport { ApiTags, ApiOperation, ApiResponse } from '@nestjs/swagger';\nimport { PrismaService } from '../../prisma/prisma.service';\nimport { UpdatePricingConfigDto } from './dto/update-pricing-config.dto';\n\n@ApiTags('Pricing Configuration')\n@Controller('api/v1/pricing-config')\nexport class PricingConfigController {\n  constructor(private readonly prisma: PrismaService) {}\n\n  @Get()\n  @ApiOperation({ summary: 'Get active pricing configuration' })\n  @ApiResponse({ status: 200, description: 'Returns the active pricing configuration' })\n  async getActive() {\n    return this.prisma.pricingConfig.findFirst({\n      where: { isActive: true },\n      orderBy: { createdAt: 'desc' },\n    });\n  }\n\n  @Put()\n  @ApiOperation({ summary: 'Update pricing configuration' })\n  @ApiResponse({ status: 200, description: 'Pricing configuration updated successfully' })\n  async update(@Body() updateDto: UpdatePricingConfigDto) {\n    // Get the active config or create default\n    let config = await this.prisma.pricingConfig.findFirst({\n      where: { name: 'default' },\n    });\n\n    if (!config) {\n      config = await this.prisma.pricingConfig.create({\n        data: {\n          name: 'default',\n          isActive: true,\n        },\n      });\n    }\n\n    return this.prisma.pricingConfig.update({\n      where: { id: config.id },\n      data: updateDto,\n    });\n  }\n}\n\n"],"names":["PricingConfigController","getActive","prisma","pricingConfig","findFirst","where","isActive","orderBy","createdAt","update","updateDto","config","name","create","data","id","summary","status","description"],"mappings":";;;;+BAOaA;;;eAAAA;;;wBAP8B;yBACQ;+BACrB;wCACS;;;;;;;;;;;;;;;AAIhC,IAAA,AAAMA,0BAAN,MAAMA;IAGX,MAGMC,YAAY;QAChB,OAAO,IAAI,CAACC,MAAM,CAACC,aAAa,CAACC,SAAS,CAAC;YACzCC,OAAO;gBAAEC,UAAU;YAAK;YACxBC,SAAS;gBAAEC,WAAW;YAAO;QAC/B;IACF;IAEA,MAGMC,OAAO,AAAQC,SAAiC,EAAE;QACtD,0CAA0C;QAC1C,IAAIC,SAAS,MAAM,IAAI,CAACT,MAAM,CAACC,aAAa,CAACC,SAAS,CAAC;YACrDC,OAAO;gBAAEO,MAAM;YAAU;QAC3B;QAEA,IAAI,CAACD,QAAQ;YACXA,SAAS,MAAM,IAAI,CAACT,MAAM,CAACC,aAAa,CAACU,MAAM,CAAC;gBAC9CC,MAAM;oBACJF,MAAM;oBACNN,UAAU;gBACZ;YACF;QACF;QAEA,OAAO,IAAI,CAACJ,MAAM,CAACC,aAAa,CAACM,MAAM,CAAC;YACtCJ,OAAO;gBAAEU,IAAIJ,OAAOI,EAAE;YAAC;YACvBD,MAAMJ;QACR;IACF;IAlCA,YAAY,AAAiBR,MAAqB,CAAE;aAAvBA,SAAAA;IAAwB;AAmCvD;;;;QAhCkBc,SAAS;;;QACVC,QAAQ;QAAKC,aAAa;;;;;;;;;QASzBF,SAAS;;;QACVC,QAAQ;QAAKC,aAAa"}